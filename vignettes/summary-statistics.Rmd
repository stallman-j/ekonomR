---
title: "Summary Statistics"
layout: single
toc: true
toc_label: "Contents"
toc_sticky: true
author_profile: true
date: "2024-10-22"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{summary-statistics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

library(dplyr)
```


If you're working through this vignette with an eye towards starting your own project, I *highly* recommend first checking out the vignette [Getting Started with ekonomR](https://stallman-j.github.io/ekonomR/vignettes/getting-started-with-ekonomR/) to get your project structured in a way that's scalable, sharable, and documentable. 

You can check out the full list of vignettes [here](https://stallman-j.github.io/ekonomR/vignettes/vignettes/)

If you've already created a project using the `ekonomR` function `create_folders()`, you may want to copy the code from the end of this vignette into a file called, say, `summary-statistics.R` into your project folder folder `code/scratch` so that you can edit and refer back to it.

If you're familiar with RMarkdown or you'd like an excuse to learn it, you can copy `summary-statistics.Rmd` from [the GitHub repo for ekonomR](https://github.com/stallman-j/ekonomR/blob/main/vignettes/summary-statistics.Rmd) and save it into `code/scratch`.

# Installation 

## New Installation

If you've already installed the R package `remotes`, comment out that line with a `#` sign in front.


``` {r, eval = FALSE, results = FALSE}
install.packages("remotes") 
remotes::install_github("stallman-j/ekonomR")
```

## Re-installation 

If you've already installed `ekonomR` before starting this vignette, you'll need to re-install it correctly so that you can access this update.

First, go into the "Packages" tab in RStudio (it's in the window that's shared with tabs for `Files`, `Packages`, `Help`, `Viewer`, and `Presentation`) and make sure that `ekonomR` is *unchecked*. If you don't do this, you might get an error message or R will have to restart.

Then run these two lines in your console. This will allow the updated version of `ekonomR` to get installed into your library. If you've already installed the R package `remotes`, comment out that line with a `#` sign in front.


``` {r, results = FALSE, eval = FALSE}
install.packages("remotes") 
remotes::install_github("stallman-j/ekonomR")
```

Either way, once you've installed `ekonomR`, you'll want to bring the `ekonomR` package into your working library.


``` {r}
library(ekonomR)
```

Your R Session might ask you to download a bunch of packages. This isn't usually a problem, but because `ekonomR` is getting updated so frequently, you might run into trouble.

If you're given the option, update packages from CRAN, the package repository for well-documented R packages. If your R crashes, run the above sequence but then instruct R *not* to update the packages and see how things go. If you're still having trouble, try uninstalling and reinstalling R and R Studio and then coming back. If you're still having trouble, email me.


# Prerequisites

If you haven't gone through the vignette [Basic Plotting](https://stallman-j.github.io/ekonomR/vignettes/basic-plotting/) and you're new to or rusty with R, see the vignette [Coding Review](https://stallman-j.github.io/ekonomR/vignettes/coding-review/) for a couple key operations we'll be assuming you know.

``` {r, eval = FALSE}
## bring in the data ----

data <- readRDS(file = file.path(data_clean,"ghg_pop_gdp.rds"))

# see the varnames we have here
names(data)

# Summary Statistics ----
## Select data to summarize ----
# NOTE
# if you use a gcb_ variable, you may run into problems with logs! Why is this?
# you can still use the outcome, but you might not be able to run all the regressions
# If you can use it without error,
# you might want to look in the 02_clean_gcb to see if there's anything weird about
# the variables in there.

data_to_summarize <- data %>% dplyr::select(le_birth,
                                     le_15,
                                     le_65,
                                     tfr,
                                     pop_000,
                                     rgdpe,
                                     gdp_pc,
                                     gdp000_pc) %>% as.data.frame()

## FIND UNITS FOR GDP PER CAPITA IN THE 02_clean_merge file
var_labels <- c("Life Expectancy at birth",
                "Life Expectancy, Age 15",
                "Life Expectancy, Age 65",
                "Total Fertility Rate",
                "Population (insert units)",
                "GDP (insert units here)",
                "GDP per capita (units)",
                "GDP (units) per (units) capita")

## generate summary statistics table ----

# https://www.jakeruss.com/cheatsheets/stargazer/#the-default-summary-statistics-table

# you can also use datasummary() from the modelsummary package if you want more customizability

stargazer::stargazer(data_to_summarize,
          type = "text",
          style = "qje",
          summary = TRUE,
          covariate.labels = var_labels,
          summary.stat = c("n","min","mean","median","max","sd"),
          digits = 2 # round to 2 digits
)

#out_path <- file.path(output_tables,"le_summary_stats.tex")
out_path <- file.path(output_tables,"hw03_summary_stats.tex")

# output to latex
stargazer::stargazer(data_to_summarize,
          type = "latex",
          style = "qje", # also has aer style
          out = out_path,
          summary = TRUE,
          covariate.labels = var_labels,
          summary.stat = c("n","min","mean","median","max","sd"),
          digits = 2, # round to 2 digits
          title = "Summary Statistics",
          label = "tab:le_sumstats", # this label now redundant with float = FALSE
          float = FALSE # do this so I can use threeparttable in latex
          # and have very pretty notes
          # this removes the exterior "table" environment
)
```
